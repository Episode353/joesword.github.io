<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>breabbick</title>
    <style>
        .grid-cell {
            display: inline-block;
            width: 20px;
            height: 20px;
            text-align: center;
            font-size: 16px;
            border: 1px solid #ccc;
            cursor: pointer;
        }

            .grid-cell:hover {
                background-color: #f0f0f0;
            }

        #edit-box {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            padding: 10px;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div id="game-container"></div>
    <div id="player-position">Player Position: X, Y</div>
    <div id="edit-box" style="display: none;">
        <label for="text-input">Enter Character:</label>
        <input type="color" id="color-picker">
        <input type="text" id="text-input" maxlength="1">
        <button id="save-button">Save</button>
    </div>


    <script>
        const gridSize = 100;
        let playerX = Math.floor(69);
        let playerY = Math.floor(69);

        const gridContainer = document.getElementById('game-container');
        const grid = [];
        for (let y = 0; y < gridSize; y++) {
            const row = [];
            for (let x = 0; x < gridSize; x++) {
                row.push({ text: '.', color: '#ffffff' }); // Initialize with default values
            }
            grid.push(row);
        }
        function updateGrid() {
            gridContainer.innerHTML = '';

            const viewSize = 5;

            for (let y = playerY - viewSize; y <= playerY + viewSize; y++) {
                for (let x = playerX - viewSize; x <= playerX + viewSize; x++) {
                    if (y >= 0 && y < gridSize && x >= 0 && x < gridSize) {
                        const cell = document.createElement('div');
                        cell.className = 'grid-cell';
                        cell.textContent = grid[y][x].text; // Set text content
                        cell.style.backgroundColor = grid[y][x].color; // Set background color

                        if (x === playerX && y === playerY) {
                            cell.textContent = 'P';
                        }

                        cell.addEventListener('click', () => handleCellClick(x, y));
                        gridContainer.appendChild(cell);

                        cell.setAttribute('data-x', x);
                        cell.setAttribute('data-y', y);

                    }
                }
                gridContainer.appendChild(document.createElement('br'));
            }
        }



        updateGrid();

        // Add variables to store the current editing cell's position and references to the edit box elements
        let editingX = -1;
        let editingY = -1;
        const editBox = document.getElementById('edit-box');
        const colorPicker = document.getElementById('color-picker');
        const textInput = document.getElementById('text-input');
        const saveButton = document.getElementById('save-button');

        // Add event listener to the save button
        saveButton.addEventListener('click', () => {
            if (editingX >= 0 && editingY >= 0) {
                const selectedColor = colorPicker.value;
                const cell = gridContainer.querySelector(`[data-x="${editingX}"][data-y="${editingY}"]`);
                cell.style.backgroundColor = selectedColor;
                cell.textContent = textInput.value; // Update the cell's text content
                grid[editingY][editingX] = { text: textInput.value, color: selectedColor }; // Update the grid with the cell's text content
                editBox.style.display = 'none';
            }
        });

        // Update handleCellClick function to show the edit box with current cell data
        function handleCellClick(x, y) {
            editingX = x;
            editingY = y;
            const cell = gridContainer.querySelector(`[data-x="${x}"][data-y="${y}"]`);
            const initialText = (grid[y][x] && grid[y][x].text) || '.'; // Use "." if the cell is empty
            const initialColor = cell.style.backgroundColor || '#ffffff';
            textInput.value = initialText;
            colorPicker.value = rgbToHex(initialColor);
            editBox.style.left = `${cell.offsetLeft}px`;
            editBox.style.top = `${cell.offsetTop}px`;
            editBox.style.display = 'block';
        }


        // Helper function to convert RGB color to hexadecimal
        function rgbToHex(rgbColor) {
            const parts = rgbColor.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
            return "#" + parts.slice(1).map(part => parseInt(part).toString(16).padStart(2, '0')).join('');
        }



        function movePlayer(direction) {
            switch (direction) {
                case 'north':
                    if (playerY > 0) {
                        playerY--;
                    }
                    break;
                case 'south':
                    if (playerY < gridSize - 1) {
                        playerY++;
                    }
                    break;
                case 'west':
                    if (playerX > 0) {
                        playerX--;
                    }
                    break;
                case 'east':
                    if (playerX < gridSize - 1) {
                        playerX++;
                    }
                    break;
            }

            updateGrid();
            updatePlayerPosition();
        }

        function updatePlayerPosition() {
            const positionElement = document.getElementById('player-position');
            positionElement.textContent = `Player Position: ${playerX}, ${playerY}`;
        }

        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'ArrowUp':
                    movePlayer('north');
                    break;
                case 'ArrowDown':
                    movePlayer('south');
                    break;
                case 'ArrowLeft':
                    movePlayer('west');
                    break;
                case 'ArrowRight':
                    movePlayer('east');
                    break;
            }
        });




        //When the Page Loads, execute these commands
        window.addEventListener("load", (event) => {
            updatePlayerPosition();


            //Place Commands before here
            console.log("page is fully loaded");
        });
    </script>
</body>
</html>