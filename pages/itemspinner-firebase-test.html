<!DOCTYPE html>
<html>
<head>
    <title>Joes World</title>
    <link rel="icon" href="media/ico/favicon.ico" type="image/x-icon" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add any necessary stylesheets or scripts here -->
    <link rel="stylesheet" href=".././style.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-database.js"></script>

    <script src="../scripts/seppe.js"></script>
    <style>
    </style>



</head>
<body>

    <center>
        <div class="container">

            <div class="header">
                <iframe src="header-content.html" frameborder="0" scrolling="no" class="header-content-iframe"></iframe>
            </div>



            <div class="content-large-fill">
                <center>
                    <canvas id="canvas" width="800" height="800"></canvas>
                    <script>



                        // Initialize Firebase
                        var firebaseConfig = {
                            apiKey: "AIzaSyCqgWyZOOfVZddqVjV-ZsDpMo6b0F1UJxs",
                            authDomain: "joesworldonline-967be.firebaseapp.com",
                            databaseURL: "https://joesworldonline-967be-default-rtdb.firebaseio.com",
                            projectId: "joesworldonline-967be",
                            storageBucket: "joesworldonline-967be.appspot.com",
                            messagingSenderId: "817241549916",
                            appId: "1:817241549916:web:787af20d01f9172efaca99"
                        };

                        firebase.initializeApp(firebaseConfig);

                        // Get a reference to the database
                        var database = firebase.database().ref("strings");

                        // Retrieve the sector texts from Firebase
                        database.once("value", function (snapshot) {
                            var numStrings = snapshot.numChildren(); // get number of strings in the database
                            sectors = numStrings; // set the number of sectors equal to the number of strings
                            sectorAngle = Math.PI * 2 / sectors; // recalculate sector angle based on new number of sectors

                            snapshot.forEach(function (childSnapshot) {
                                var index = childSnapshot.key;
                                var text = childSnapshot.val();
                                texts[index] = text;
                            });

                            // Shuffle the texts array
                            texts.sort(function () {
                                return 0.5 - Math.random();
                            });

                            // Set random colors for each sector
                            for (var i = 0; i < sectors; i++) {
                                colors[i] = '#' + Math.floor(Math.random() * 16777215).toString(16);
                            }

                            // Draw the wheel with the shuffled sector texts and random colors
                            drawWheel();
                        });

                        var canvas = document.getElementById('canvas');
                        var ctx = canvas.getContext('2d');
                        var centerX = canvas.width / 2;
                        var centerY = canvas.height / 2;
                        var radius = 350;
                        var sectors = 8;
                        var sectorAngle = Math.PI * 2 / sectors;
                        var colors = [];
                        var texts = [];
                        var angle = 0;
                        var speed = 0;
                        var targetAngle = 0;
                        var spinning = false;

                        function drawWheel() {
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            for (var i = 0; i < sectors; i++) {
                                var sectorColor = colors[i];
                                var sectorText = texts[i];

                                var startAngle = angle + sectorAngle * i;
                                var endAngle = startAngle + sectorAngle;

                                ctx.beginPath();
                                ctx.moveTo(centerX, centerY);
                                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                                ctx.closePath();
                                ctx.fillStyle = sectorColor;
                                ctx.fill();

                                // Add sector text
                                ctx.save();
                                ctx.translate(centerX, centerY);
                                ctx.rotate(startAngle + sectorAngle / 2);
                                ctx.fillStyle = 'white';
                                ctx.font = 'bold 20px Arial';
                                ctx.fillText(sectorText, 250, -radius / 200);
                                ctx.restore();
                            }
                        }

                        function spinWheel() {
                            if (spinning) {
                                return;
                            }

                            spinning = true;

                            targetAngle = Math.random() * Math.PI * 2;
                            var spins = Math.floor(Math.random() * 4 + 4);
                            speed = 10;

                            var intervalId = setInterval(function () {
                                angle += speed;
                                speed *= 0.99;

                                if (angle > Math.PI * 2) {
                                    angle -= Math.PI * 2;
                                }

                                drawWheel();

                                if (speed < 0.001) {
                                    clearInterval(intervalId);

                                    var sectorIndex = Math.floor((targetAngle + Math.PI / sectors) / (Math.PI * 2 / sectors)) % sectors;
                                    var selectedSectorText = texts[sectorIndex];
                                    alert('You won: ' + selectedSectorText);

                                    spinning = false;
                                }
                            }, 10);
                        }



                        drawWheel();
                        canvas.addEventListener('click', spinWheel);

                    </script>
                </center>
                <p>To Submit action, please enter login and click <span class="word-red">Submit</span> </p>
                <center>
                    <div style="background-color: lightsteelblue; background: snow; font-size: 20px; padding: 10px; border: 3px solid lightsteelblue; margin: 10px; ">
                        <form>

                            <label for="username">Username:</label>
                            <input type="text" id="username" name="username">

                            <label for="password">Password:</label>
                            <input type="password" id="password" name="password">

                            <input type="submit" value="Submit" value="Submit" style="background-color: #CD5C5C; color: #ffffff; padding: 10px 20px; font-size: 16px;">
                        </form>
                    </div>
                </center>

            </div>



            <div class="footer">
                <iframe src="footer.html" frameborder="0" width="100%" class="footer-iframe">
                </iframe>

                <script type="text/javascript" language="javascript">
                    $('.myIframe').css('height', $(window).height() + 'px');
                </script>

            </div>



        </div>
    </center>
</body>
</html>
