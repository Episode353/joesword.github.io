<!DOCTYPE html>
<html>
<head>
    <title>Scoreboard</title>
    <!-- Include Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
    <h1>Scoreboard</h1>
    <table>
        <thead>
            <tr>
                <th>User</th>
                <th>Points</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="scoreboard-body">
            <!-- Data will be loaded here -->
        </tbody>
    </table>
    <form>
        <label for="username">Username:</label>
        <input type="text" id="username" required>
        <label for="points">Points:</label>
        <input type="number" id="points" required>
        <button type="button" id="submit-button">Add Score</button>
    </form>

    <script>
        // Initialize Firebase with your project's configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCqgWyZOOfVZddqVjV-ZsDpMo6b0F1UJxs",
            authDomain: "joesworldonline-967be.firebaseapp.com",
            databaseURL: "https://joesworldonline-967be-default-rtdb.firebaseio.com",
            projectId: "joesworldonline-967be",
            storageBucket: "joesworldonline-967be.appspot.com",
            messagingSenderId: "817241549916",
            appId: "1:817241549916:web:787af20d01f9172efaca99"
        };

        firebase.initializeApp(firebaseConfig);

        // Reference to the Firebase Realtime Database
        var database = firebase.database();

        // Function to add or update a user's score
        function updateScore(username, points) {
            database.ref('scores').child(username).once('value', function (snapshot) {
                var userScore = snapshot.val();
                if (userScore) {
                    // Update points for existing user
                    var updatedPoints = userScore.points + points;
                    database.ref('scores').child(username).update({ points: updatedPoints });
                } else {
                    // Add new user with points
                    database.ref('scores').child(username).set({ points: points });
                }
            });
        }

        // Function to remove a user's score from the database
        function removeScore(username) {
            database.ref('scores').child(username).remove();
        }

        // Function to update the scoreboard on the page
        function updateScoreboard(snapshot) {
            var scoreboardBody = document.getElementById('scoreboard-body');
            scoreboardBody.innerHTML = '';

            snapshot.forEach(function (childSnapshot) {
                var score = childSnapshot.val();
                var username = childSnapshot.key; // Get the username from the snapshot key
                var row = document.createElement('tr');
                var userCell = document.createElement('td');
                var pointsCell = document.createElement('td');
                var deleteCell = document.createElement('td');
                var deleteButton = document.createElement('button');

                userCell.textContent = username;
                pointsCell.textContent = score.points;
                deleteButton.textContent = 'Delete';
                deleteButton.setAttribute('data-username', username);
                deleteButton.addEventListener('click', function () {
                    var usernameToDelete = this.getAttribute('data-username');
                    removeScore(usernameToDelete);
                });

                deleteCell.appendChild(deleteButton);

                row.appendChild(userCell);
                row.appendChild(pointsCell);
                row.appendChild(deleteCell);
                scoreboardBody.appendChild(row);
            });
        }

        // Event listener for the submit button
        document.getElementById('submit-button').addEventListener('click', function () {
            var username = document.getElementById('username').value;
            var points = parseInt(document.getElementById('points').value);
            updateScore(username, points);
        });

        // Listen for changes in the 'scores' node and update the scoreboard accordingly
        database.ref('scores').on('value', function (snapshot) {
            updateScoreboard(snapshot);
        });

    </script>
</body>
</html>
