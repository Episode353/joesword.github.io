<!DOCTYPE html>
<html>
<head>
    <title>Joes World</title>
    <link rel="icon" href="../media/ico/favicon.ico" type="image/x-icon" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add any necessary stylesheets or scripts here -->
    <link rel="stylesheet" href="../style.css">
    <script src="../../seppe.js"></script>
    <style>
    </style>

</head>
<body>


    <center>
        <div class="container">

            <div class="header">
                <iframe src="header-content.html" frameborder="0" scrolling="no" class="header-content-iframe"></iframe>
            </div>



            <div class="content-large-fill">
                <div id="whiteboard"></div>
                <script>
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    canvas.width = 800;
                    canvas.height = 600;

                    document.getElementById('whiteboard').appendChild(canvas);

                    let isDrawing = false;
                    let lastX = 0;
                    let lastY = 0;

                    canvas.addEventListener('mousedown', e => {
                        isDrawing = true;
                        lastX = e.offsetX;
                        lastY = e.offsetY;
                    });

                    canvas.addEventListener('mousemove', e => {
                        if (!isDrawing) return;
                        ctx.beginPath();
                        ctx.moveTo(lastX, lastY);
                        ctx.lineTo(e.offsetX, e.offsetY);
                        ctx.stroke();
                        lastX = e.offsetX;
                        lastY = e.offsetY;
                    });

                    canvas.addEventListener('mouseup', () => {
                        isDrawing = false;
                    });

                    const socket = new WebSocket('ws://localhost:3000');

                    socket.addEventListener('open', () => {
                        console.log('Connected to server');
                    });

                    socket.addEventListener('message', event => {
                        const data = JSON.parse(event.data);
                        if (data.type === 'draw') {
                            ctx.beginPath();
                            ctx.moveTo(data.lastX, data.lastY);
                            ctx.lineTo(data.x, data.y);
                            ctx.stroke();
                        }
                    });

                    canvas.addEventListener('mousemove', e => {
                        if (!isDrawing) return;
                        socket.send(JSON.stringify({
                            type: 'draw',
                            x: e.offsetX,
                            y: e.offsetY,
                            lastX,
                            lastY,
                        }));
                        lastX = e.offsetX;
                        lastY = e.offsetY;
                    });

                </script>
            </div>



            <div class="footer">
                <iframe src="footer.html" frameborder="0" width="100%" class="footer-iframe">
                </iframe>



            </div>



        </div>
    </center>
</body>
</html>
